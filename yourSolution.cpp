#include "yourSolution.h"

CKKSTaskSolver::CKKSTaskSolver(std::string ccLocation, std::string pubKeyLocation, std::string multKeyLocation,
                               std::string rotKeyLocation,
                               std::string inputLocation,
                               std::string outputLocation) : m_PubKeyLocation(pubKeyLocation),
                                                             m_MultKeyLocation(multKeyLocation),
                                                             m_RotKeyLocation(rotKeyLocation),
                                                             m_CCLocation(ccLocation),
                                                             m_InputLocation(inputLocation),
                                                             m_OutputLocation(outputLocation)
{

    initCC();
};

void CKKSTaskSolver::initCC()
{
    if (!Serial::DeserializeFromFile(m_CCLocation, m_cc, SerType::BINARY))
    {
        std::cerr << "Could not deserialize cryptocontext file" << std::endl;
        std::exit(1);
    }

    if (!Serial::DeserializeFromFile(m_PubKeyLocation, m_PublicKey, SerType::BINARY))
    {
        std::cerr << "Could not deserialize public key file" << std::endl;
        std::exit(1);
    }

    std::ifstream multKeyIStream(m_MultKeyLocation, std::ios::in | std::ios::binary);
    if (!multKeyIStream.is_open())
    {
        std::exit(1);
    }
    if (!m_cc->DeserializeEvalMultKey(multKeyIStream, SerType::BINARY))
    {
        std::cerr << "Could not deserialize rot key file" << std::endl;
        std::exit(1);
    }

    std::ifstream rotKeyIStream(m_RotKeyLocation, std::ios::in | std::ios::binary);
    if (!rotKeyIStream.is_open())
    {
        std::exit(1);
    }

    if (!m_cc->DeserializeEvalAutomorphismKey(rotKeyIStream, SerType::BINARY))
    {
        std::cerr << "Could not deserialize eval rot key file" << std::endl;
        std::exit(1);
    }

    if (!Serial::DeserializeFromFile(m_InputLocation, m_InputC, SerType::BINARY))
    {
        std::cerr << "Could not deserialize Input ciphertext" << std::endl;
        std::exit(1);
    }
}



void CKKSTaskSolver::eval()
{
    std::vector<std::vector<double>> W = {{0.27346475175277885, -0.6813706837218608, 0.2574576991953107, 0.647462655488592, 0.46150071253462066, -0.03036673789730074, 0.20256288807919573, 0.2756242806671517, 0.9520855446242613, 0.23421671462523216, -0.38260212723529, 0.33497418802526163, -0.32109912733341217, -0.03043931982603504, 0.8393827436169692, 0.4503328999005303, 0.3681809771039201, 0.2276731364984872, -0.19882695003898093, -0.38517866879235596, -0.05621288269826644, 0.8661901590578865, 0.6099074239146661, 0.7902182839647943, -0.3988187190034143, 0.5095388382072608, -0.17649704038703193, -0.6114513613432392, 0.05628412495855079, 1.5792399431290947, -0.47655684112473706, 1.049028186199212, -0.4392865121956189, 0.12986437425052208, -0.5899005677911946, -0.7892641572702209, 0.32960942744386695, 0.12172404677192493, 0.17585618907740375, 0.8717794911086127, 1.1047241309540456, -0.6960971103543825, 0.6027180977137915, -0.1777342867514944, -1.0134761654914686, -0.5113945400849264, -1.0482395792545014, 0.5349139706064563, -0.3103024907153613, -0.920098270901085, 0.5011542046327727, -1.5423037949832883, 0.9024168629140288, -0.1374218410705205, -0.13243666299939091, -1.1445317996422786, -1.5670713776878893, 0.22702147401587847, -0.15633675818653078, -0.7585649872298355, 0.3757918759701711, 0.671052910624208, -0.13392294887953124, 0.503833405742103, -0.9774691942214226, -0.9770381475760983, -0.2531601662188686, -1.2549890452661856, -0.8272572732359428, -0.9662663508861328, -0.10649420359566741, 0.21425964771822065, 0.8486660422221459, 0.5390656899555697, -1.3634582953336334, -0.8757301313954059, 0.10496436757146566, 0.2924655316161754, 0.9969913114021448, -0.1436924114786866, -1.3041735961988286, 1.1443636628402742, 0.10792163364697685, 0.5204458330437773, 0.4322557823089897, 0.21519980105655223, -0.4927722930893204, -0.41339454413669074, -0.21451899473631086, 0.18842487657825444, -1.40893600455594, -0.5516045003294858, 0.4108125860725306, -0.636407877853965, -0.34160699052739724, 0.04027577780593039, -0.8048352117392251, 0.07065353621649026, 0.6808776483863904, -0.20536181578165574, -0.49296931330308214, 0.014149562076773238, -0.10337519163690682, -1.0701994258814658, -0.25303778092514034, -0.3830389094038831, 0.7737028459226806, -0.8204582704789548, 1.6657854541923733, 0.26926737429556574, 0.6891137740330316, 1.8959943542980844, 0.2624465943734764, -1.2829192723207918, 1.1061500931659198, 0.2013009662652475, 0.3850730336730466, -0.5588740959485118, -0.41980674054818523, -0.14528638878130978, -1.1591693027415506, 0.44010976129964346, -0.06980675432122212, 0.6955990622282593, 0.34936712573260414, 1.0116399679856172, 0.13204665130187065, 0.02513389518728528, 1.2740698696928312, -0.09640227200572736, -0.989052520068685, -0.2975788327116926, -0.9988394381580746, 0.0971892987148384, 0.6196350487796198, -0.12469850034918309, -0.8905947905565638, -0.17593243192755964, -0.15533461147525826, 0.2339453414863867, 1.6076501674519668, -0.36644787788326494, 0.345061113486372, -0.2303951066558609, -0.7388715563780047, 1.3820371293054128, 0.2857252263836364, -0.21647871744139302, -1.1361140728155203, -1.0271070374894904, -0.06399694582877943, -0.6256562027171215, -0.001461036904523576, 0.19695288910991599, 1.6225337976593217, -0.24484236846070032, 0.4095790350664705, 1.1471469863556196, 0.4176123880436048, -2.0310921550005023, 0.34682461608087606, -0.9447821973929726, 0.44230640025899687, 0.9656026076605473, 1.474678919034274, -0.9071928439577651, -0.9071003752756674, 0.18832727420854492, -0.6042364407214127, -0.10701380136658666, -0.25868879344088647, 0.697043975358454, -0.11311190837655213, 0.005093693735912818, -0.7614096564227676, 1.261061152197191, -0.04734934475115959, 0.10179905309011798, -1.2997480381777795, -0.6814685718631127, 0.3601449380215327, 0.2810321422565688, 0.5700478189513962, -0.9353057578560362, 0.20560894904173752, -0.4171271162068253, -1.6021765365679952, -1.3484935402323008, -0.07957459146960168, -0.8703085453818331, -0.8093567986969584, 1.130079302304547, -0.33749402451678123, 0.041044355022360236, 0.673334268523302, -1.6751011660012138, 0.5797578417561663, 0.1568885816962512, 0.2117066014668541, -0.29382026443705184, 0.8666015047381137, -0.8103492623845043, 0.4609175280022472, -1.0037090452767152, -0.3003187927160674, -2.008179642019847, -1.5565937050368948, -0.15117828775998743, -0.28477918080122877, 0.15985077744343978, -1.2595330607024686, -0.5541497221601562, 0.06796066457025339, -0.17915613765977514, 0.13495012132152534, -0.4104518709839281, 0.235485607476214, 0.04905483542400802, -0.40000936064092507, -0.1866237430789822, 0.3190956443909234, -0.6250013292549418, -0.5612235156192055, -1.1383588902805333, 0.5882645725399892, 0.11466370358834732, -0.6763811136035309, -0.5858884330604788, -0.295272101759479, -1.4643226819871613, 0.2071374355127408, -0.2949601978011211, 1.6567391295669571, 0.011439414619142302, -0.5903432126078626, 1.3625661680421859, 0.15554556742979642, -0.13934701556761392, -1.0309211756944792, -0.4488228714942817, -0.3677271049881114, 0.5689765187060015, 0.006814328236242026, 0.8100501309742074, 0.6693367251632166, -0.4888680971128876, 0.3208484638375022, 0.02381030421385322, 0.005405298426983546, -0.326174953871958, -0.08706088336443824, 1.102347216118306, -1.4708003351781156, -0.6100900861573014, 0.3321996857958788, 1.5929255234381705, -0.338574947451023, -0.36010740480335207, 0.728279515474601, 1.0282044249957611, 0.6119180825943215, -0.3032798508514088, 0.2060751769575559, -0.4393574599164221, -0.5608790662808382, -0.5194026976267604, 0.34943514822016974, 0.005538771409224811, 0.5416035028689775, -0.5566577651127576, -0.5561354425262586, 0.1297167169222181, 1.1207818542214405, -0.5512137112809268, 2.1684687616333553, -0.42510492313364584, -0.43282387066622147, -0.54164209741384, 0.15319504998243583, 0.9319385523934437, 0.1555840075708984, 1.1316695240470258, -0.676018954285103, -0.08036830115248901, 0.11636595059653997, -0.5209300944169407, 0.41597204315650604, 1.0152717786136418, -0.6110501964850182, -0.22867439464363748, 0.6371760505208782, -0.1823814801774912, -1.2668897104972883, 1.2551576421763777, -0.021561854063226398, -0.20555778657386312, -2.0314386270522724, 1.484383069743348, -1.2237005200146074, -0.3615025297994311, -0.3199222780661805, 0.7426337634204384, -0.30368162233054014, 0.35261103778177655, 1.5933814384202734, 0.2756957792744457, 0.611577599823122, -0.2649248449662741, -0.3029095644767435, -0.01869882917347148, 0.8139058847727552, -0.34032762439497294, 0.9572778726978619, 0.04626192977765926, 1.6095720751231228, 0.5641515593768331, -0.02955423529201042, 1.545874101448642, -0.38963319528694423, 0.6275234367688235, 0.5435648444545182, 0.393381804189123, -1.0125082002219714, 0.5489319597998499, 0.35794998785859955, 0.651574621447785, 0.11849837605881756, -0.16708919648214443, -0.3379989330228395, 0.1548767198016611, -0.22081326479185864, -0.5020402996317713, -0.20048601578314018, -0.5170961244435166, -0.07673212852273135, 0.11621229616401454, 0.3562296540308767, 0.9375008655149543, 0.3736689849201483, 0.21168894447902165, 0.44435876899507015, -0.015717386099600654, -0.37144634332664334, -2.4791628060317326, 0.3031208864367468, 0.0124206916892775, -1.246851911467968, 0.930690530862247, -0.38309969867977806, 0.09248677534109455, 0.762969762486354, -0.33418395676338486, -0.17479150951755795, -0.15873317900553416, -1.1757293856684763, -0.7542584758854947, 0.2883592435189425, -0.364809325040389, -0.3243156540307621, 1.1182566112762355, 0.02788234482819194, -0.5567522895747652, -0.21345624486315423, 0.1473162417360242, -1.1880304814842662, 0.31012878093207524, 0.08978441773842703, -0.4194994490927468, 0.40197926914090576, 0.014379356125451782, -0.15809809995429555, 0.3962953612064118, 0.007464879816395811, 0.4584790071254228, -0.3819676622530042, 0.6680185597221093, 0.42355885149506717, -0.04728261161538527, -0.1828968670863984, -0.7730960393437422, 1.4000250553448557, -0.5279064209618279, 0.5718307780659431, -0.34649524177074176, 1.474097419965063, -0.7796502522870644, -0.4952150625851372, -1.866815613598048, -0.08053091217337104, 0.4852953509389687, -0.19634662878929324, -0.4898681855328447, 0.4509844349628531, -0.1262619647832687, 0.8325670707798646, -0.5764662236750259, -0.7357788485195477, 1.465854570088527, 0.2103657818528086, 0.06854370644143788, 0.4612842275109556, 0.5176059528312142, 0.9221339960521648, 0.6430833456398342, 1.559808237013224, 0.6059111084966124, -1.1016552242426856, 0.28661541899815157, -1.1347752135056994, 1.375651496819522, -1.0304488416577882, 0.4999827580684428, -0.8676542883669195, -0.13196012381969127, 1.559101071089924, 0.6021145930274717, 0.46329569071207605, 0.9870247790791812, 0.2974053580872977, -0.5093071665481211, -0.119197248944572, 0.3552176051430028, -1.120883664849666, -1.152061333518056, 0.20021911816895413, -0.8365128024281717, -0.9376395161036795, 0.2527914681084035, 2.1527665249723253, -0.9619407604613893, 0.4748722015290224, 0.43318756351642357, 1.1732788003184247, 0.4196873186724785, 1.9555691819599403, -0.7615156170928983, -0.24705481220850734, -1.2698738341538836, 0.49240470395025765, 0.23886170467839085, -0.5027621543214094, -0.03867097569953699, -0.02710972459726663, 0.15125789650064125, 0.2768203019616648, -0.6932298200840051, 0.06428276237624178, -0.7156893768488328, -1.1452078832806647, -0.1581293233942317, -0.0797110035623918, -0.3081456733622022, 0.6689565848376859, -0.7225497360348666, -0.6540236588989862, -0.12153189194665544, 0.006086222345258489, 0.8367082661998377, -0.8998033257465334, -0.2782414935407282, -0.6802149273173536, 0.5460863589464839, 1.4249395795506592, -0.8105266505171786, -1.1227642427400943, -0.3416233613824169, 0.047578396720814986, 0.6693928920882096, -1.1139983301292125, -1.2133154909678123, 0.7019318473440384, -0.18925116145273732, -0.28563743497025584, 0.5726922970557837, -0.3359655970456374, 0.8116731913596005, -0.5927524240272309, -0.658345883239837, 0.10588671382106919, 1.7158412460125867, -0.21285929368929857, -2.012789276352877, 0.7791030007090483, 0.3694907056547955, -0.8389473454805487, 0.9725562411866437, 0.276094375832341, -0.674931941815589, 0.7778916681891173, 0.21741954341043027, -0.17633634590542374, 0.5134766138874026, -1.4543693106145859, 0.15576907553115574, -0.6336372724648475, 1.6982136544794932, -0.8092340199361154, 0.9843251719542403, 0.28749385631717417, 0.6415955163528493, 0.38820676407144955, 0.04700518913141409, -0.6511779331897565, -0.8145398299657841, 1.4452484510217718, -0.39356598188644715, -0.8573306093977551, 0.14401475603682373, -0.7590485813779704, 0.566303843500129, 0.20448495701861644, 0.445096388186945, 1.495925644881141, -0.791230037214686, -0.8268253594877562, 1.412250253426442, 0.26842303514051363, -0.14292704620867022, -0.23914721969505018, -1.4423082283427096, 0.28937825118906474, 0.8693986627512438, 0.40539178163778566, 1.0123749095700367, -0.6680334547600477, -0.8731919106442487, 0.3561219790922945, 1.7553156823111966, -1.7382083645798383, 0.930347096012242, 0.09580445931894165, -1.204091793498288, -1.2365857732700183, -1.3291863138702738, -1.1995760332865637, 0.6253322942630787, 0.8831221657216571, 0.7299208937011237, -0.29260071828132034, 0.9405683869286513, 1.4662676105428085, -0.1034842108359339, -1.1832385765943172, -0.7642794582343545, -0.42898795773227094, -0.5204751916654398, 1.4447427156023949, -0.22461171576433228, 0.9897637020591393, -0.5788272544698482, 0.9426638941305817, 0.5707941784199171, -0.13111327644131218, -0.6094449821760118, -0.29859695275090914, 0.6290387563068471, -0.2606024052520811, 0.4144998005146833, -0.6372373664155895, 0.18035272180632275, 0.040881733858679464, -0.4115646190767817, -0.6202920019724862, 0.6537899628924192, 0.63940111626165, -0.7246133909455654, -0.9424662143338017, 0.8840004976485096, 0.7474384648393337, -0.14734184366014175, -0.25604218421510655, 0.7011412574634109, -0.6067310066305411, -1.921987722658865, 0.3282104411876983, 1.158230179383033, -0.37837558480971745, 0.11187186541725241, 0.32043287820187477, -0.8908342403699608, 0.028319509098072047, -0.10184946215312456, -0.4464838072753946, -0.5171243573404118, 0.8209753416273722, 0.3757915392887435, -0.05637061565446781, -0.3998402119508186, 1.1827343541529207, 0.5281525013722, 1.0704700375065341, 0.9324126769595787, -0.760879142072301, 0.946674856323472, -0.9176426084643565, 0.7462478393491329, -0.40726424711658094, 0.4499765634953633, -0.2082190378380103, 0.6799429606895124, 0.4837083857198996, -2.062720945858911, 0.045180740088109295, -0.5900976394078481, -0.5233330970653266, 0.4274154351526151, -0.036283823657846576, -0.3860029008672451, -0.8146265652588689, 0.30650643291636837, 0.38376262010481604, -0.6765173044975621, 0.8986061656462666, -0.16106374320866548, -0.7651645268612008, -0.7094783556814146, -0.4374944878125942, -0.04704587522939665, -0.8541312037737616, -0.6971462175026011, -0.5416329119969884, 0.710482052861084, 0.23831172436912995, -0.9121671316553749, 0.6730094662782334, 0.005784482340068965, 0.584394133620629, -0.5405771145582794, 0.31797944990527166, 0.5703947604346667, 0.2946932967608837, 0.36714915674402543, -0.03888074133386529, 0.20402669673909604, 0.560599563635957, -0.784943153457691, -0.44965054832714724, -0.15286127350354645, -0.5310342217259505, -0.1017505964141414, -0.08153699278026903, 0.4790520655622491, -1.7896515604868581, 0.5494998177069101, -0.6403991772542966, -1.3532154209900418, 0.1321112381101838, 0.19105260358346704, -0.2345068387919848, 0.016508771738202848, 0.16842183365570645, 0.38452961215210163, -0.5906649037883118, 0.4432785954381586, 0.46686345848525707, 1.095202903835879, -0.79851322252573, -0.7550525934672545, 0.2611825791995639, 0.03357231523487373, -0.03896855801291795, 1.084634788010607, -0.5424092623272426, -0.45701669339727746, -0.5839707861668194, 0.2973347599637144, 0.1400526746833658, -0.3665139536666913, 0.5431312458758429, -1.0470016521171235, -0.949922922677306, -0.25371556558028135, 0.42965486813279463, 0.06817267595430523, 0.4097236621728069, -0.04219528495960887, 0.7540214865555136, 0.4026677865723656, -0.1946125464626936, -0.8163709469707017, -0.9686965519748766, 0.28641811632977004, 0.025493289635088724, -0.3812710100379277, -0.12048968888248379, -0.5457539013976915, 0.6477363981141299, 0.7327459406250199, 0.5481426886722566, 1.3165501385312819, 1.2723602733371775, 0.7819363525639208, -0.38499332704189654, -0.11959837356833365, 0.9894670097133967, 0.5100909743634948, -0.47774400597663064, 0.5221119388989862, 0.07766071150276373, -1.5405217529279267, -0.6406163044439879, 0.22669503420444462, 1.114590942363599, 0.7253114546522559, -0.7557818495342498, 0.9472391687470596, 0.5726705392125311, 0.6111082781089956, 1.392673112509491, 0.388422873765264, 1.7973176460876414, -0.08641296074677095, -0.04682976653529373, -1.3289505591746273, -0.9685164391135449, -1.1683887639462465, 0.5941902057752718, -0.535213538002007, 0.7941480748300973, -1.873652976305002, -0.4907925570676236, 1.0754264939146392, -0.42894894442242076, -1.4674140415208163, 0.9806321235888965, 0.03888651846453885, 2.363594357089177, 0.3931281028839411, 2.122652173304491, -0.36896497480440243, -0.5482735466869428, -0.0781677189667356, 0.18756440485205836, 0.6522004937950378, 0.15105286967193715, 0.9279099051635663, -0.24385034328085864, 0.6878401216871374, 0.13136365884707157, -1.1365860158222543, -0.5431145071559702, 1.2685045576157217, -0.47712444123568976, 0.39799888901650843, 1.0004428601465665, -0.29609671997278947, -0.4433842361224486, -1.053851567273832, 1.0384156697789368, 0.22237778257510052, -0.1910401925639302, -1.0742972756804634, -0.09057273780694507, 1.1781236339772836, 0.6535984126967317, -1.0142879710049137, -0.008267112061234608, 0.26796199775569995, -0.44279416890913914, -0.4058068799846234, 0.09629873863377977, 1.0890180817474464, -0.09153287382211489, 0.40244503320636793, 0.3492017095532072, 0.4792371720169478, 0.22380384338417392, -0.4069429979401528}, {0.2674099383021286, -0.6983367394367879, -0.4545581141624534, -0.971011866905399, -0.22287806252235753, 0.11265581416564284, 0.26774570603619313, -0.5810337437573025, -0.8936241897321968, 0.34427411941396063, 0.12948084851755332, -0.3631339034188091, 0.3674071091185402, 0.019335833195546808, -1.3112821944492858, -0.02531448393589308, -0.7901082065873473, -1.0023431096380822, -0.6553489951036704, 0.07333726530367352, -0.024802134599491467, -0.8551281379420832, 0.8984199288461234, -0.007480178575607162, 1.228516874480986, -0.0023282120958116673, 0.8173291695816903, -0.19177493306877708, -0.19603511467854895, -0.9240815082032172, 0.2622011386793944, 0.2634621305631585, 0.19593409199266446, 0.10616247160916202, -0.43419378864567465, 0.44674460210910344, -0.22664914481982004, -0.08469433316007398, 0.3390782108818338, -0.5822703967748487, -1.562569398571127, -0.07903314630892078, -0.3857915616239681, 0.28502678898449507, 0.716341873275194, 0.40729197344566465, 0.33457606406389134, 0.5235077089283824, 0.25989675107125026, 1.3849119490308401, -0.8960708020637809, 0.29811032173700713, -1.0983008045761862, -0.016739401815306264, 0.050838295410031716, -0.17602777925178723, 0.3215020010881529, -0.411768213221711, 0.288538759629899, 0.26633441232141847, 0.18146302571752662, -0.3553182668370948, 0.638828551940801, 0.7368365066194001, 0.43749654703008195, -0.20466536509948347, -0.21132498560748636, -0.7900930680337132, 0.5163852873387895, 0.20177857997138082, -0.2910453696590777, -0.23374205793880387, 0.11044446179239437, -0.7159857636312331, 0.3902993439548223, -0.4484813470564427, -0.08600089770088486, 0.6150521260310176, 0.03299519220248818, -0.23164804862784114, 0.17627810259833118, -0.37386632136809145, 0.7092792530998605, 0.3294680171399414, -0.15500361148286732, -0.3408161893998133, -0.23648001416889164, 0.5076243262096565, 0.49635735546717497, -0.34448424941965144, 0.8575830087094479, 0.15939901863839218, 0.8785387948265193, 0.5661350370089444, 1.1521052323481813, 0.23008597561096733, -0.023018920483337164, -0.18034019191157194, 0.2220494070376843, 0.014008463313438791, -0.48503010195271373, -0.13615248481255493, -0.09999477775874399, -0.6147574906157113, 0.10202319316714163, -0.3120836062009688, 0.278258019108685, -0.0582509974391968, -0.5802509231449018, -0.0035504158737998492, -0.46174346553697676, 0.28941040957900216, -0.35154389770930566, 0.5757834535481451, 0.02953364562201456, -0.3190433685317751, 0.07488563322517798, 0.4351988803666477, 0.24928794099180812, -0.7391151900156855, 0.2450686439575226, -0.5050216701338304, -0.43122445626643535, 0.3305310589628525, 0.576441400189763, -0.1150356212265111, -0.043888427270491165, -0.3641035495378058, 0.12397168588944456, 0.033318806995001615, 0.544587574474421, 0.31565368301937047, 0.6591345262319384, -0.39091377977441294, -0.5082140835491717, -0.0285421788248712, 0.12087097699228615, 0.007814312655383692, 0.44749206983511625, 0.6521119754835577, -0.0845805109492497, -0.7146563780371148, 0.34644567108538826, 0.568359441586692, 0.11186897443369673, -0.2269804888279416, 0.45878618044790964, -0.7013298788786803, -0.13047526151483932, 0.4436664988843485, 0.3870604231034317, 0.30753649545917366, -0.49845312370013767, 0.3819440750496109, 0.284658907692845, 0.0938107859069319, -0.6690247954938633, 0.3477135488416727, 0.36929317205884926, 0.44851725013379345, 0.13209383019538376, 0.2630755617749298, 0.4373017770954202, 0.2629470443907039, -1.6350470692079446, -0.062233639725638175, 0.21532982894935418, 1.0304619230416099, 0.4874722531587763, -0.6923497180961242, 0.4528049844031477, -0.20508108025577157, -0.7340585373361199, -0.5149843519341829, -0.32636567838056374, 0.424497051552326, -1.0361835162817132, 0.7509335461446559, 0.49322790132106387, 0.7346352341864132, 1.0575987563072622, 0.03856457559510596, -0.08968325957944619, 0.7438121970788623, 0.36494762876021575, -0.11916705795232453, -0.15025274013776319, 0.22881601546654526, -0.09838853228308482, 0.3711670644038899, 0.2140922190112762, -0.7467409960187728, 0.4163010796166224, -0.5126614449737766, 0.3758294432119005, 0.19273210848011652, -1.2837349757163252, -0.4078641835431284, -0.28250033442849304, -0.6292680785222955, 0.5595775690130298, 0.6199561905580058, -0.09528930440863552, 0.2435452362646809, 0.48046618539649344, -1.4104713586571616, 0.49319506314220235, -0.23749716935051798, 0.23542743490223414, 0.43366839220524006, 0.7887109577804431, -0.05677938605401223, -0.10362084410585015, -0.2054406838758954, -0.6136867650949758, -0.15964039650567657, -0.5138413315544448, 0.007130522991916702, 0.8122414768131901, 0.3621384954052985, -0.6441714192367707, -0.20687190279991918, -0.23761367927454688, 0.3482627897512419, -0.07892891779039167, 0.27926547725067, 0.30454285293679595, -0.3645634965467486, 0.9382009854438413, 1.7576462803102832, -0.16430352446667032, -0.5272692415681455, -0.25525849424646696, -0.24837995355551595, 0.6658612682131843, -0.4222163845758244, -0.7499097939025954, 0.34697563088506506, 0.4363812127037455, -0.7697866002879327, 1.1201093723431486, -0.4990502208459177, 0.8124056448693131, 0.01513397081287537, -0.1027492383646557, -0.8491890301767936, 0.6919522619057094, 0.1688704394555758, 0.10057018825098359, 1.2180399806942364, -0.1060828182525865, -0.5274682777195594, 0.11872984580768642, 0.5565013218833791, 0.25038125101721465, 0.08470054046058814, 0.547255960551851, -0.2934080433777527, -0.2502224675866172, 0.03373253743412615, -0.27834631586431974, 0.32381479399545166, 0.454176038880351, 0.43834642640369637, 0.33364388492687297, 0.19135478147169552, -0.2791591451752397, -0.3489489568418533, -0.7641475309040076, -0.03050971426640957, 0.7230937416497658, 0.3230124543634239, -0.3708032878565944, -0.4674031659156164, -0.31163059995856274, 0.16012364422051462, 0.4434093551317762, -0.24649510541687622, 0.6868505540623794, -0.1341688255679902, -0.35607014036635043, -0.09492226537092929, 0.12344058913556905, -0.03097369931247079, -0.13715166797053338, -0.4833534682786424, 0.31296269413070893, -0.5681172179757302, 0.01507634581917899, 0.18981199774658253, -0.24071772792532842, 0.14493084058269964, 0.422542122456668, -0.03869842626143286, 0.4018545402625316, -0.4578734987801482, 0.1035661650224771, 0.28146833115784164, -0.06945526650582658, -0.20274739515375975, 0.339773809926696, -0.936112174432, 0.4727309109692592, -0.39822330448532045, 0.8795906448817176, -1.10742696256148, -0.2493313003975772, -0.7233862197190777, 0.646594832409293, -0.12533747721590205, -0.14956496731862415, 0.9820318269620694, -0.3289907745598864, 0.4676776271089852, -0.6017218663858428, 0.2525439654870107, 0.41438613115940026, -0.5969263934782458, -0.15759546660534896, -0.2761183272480559, 0.2740562859672537, 0.450693127676031, 0.6111837739752013, 0.24728815260771997, -0.45710972117596993, -0.2711754219008061, -0.3357720183710023, -0.4687222557036067, -0.596185632888511, -1.0668639158392197, 0.6071816674126455, 0.49254552569726584, -0.6224584590721155, -0.32767875795008605, 0.6055396491800803, 0.5188334351105371, -0.010328262909096338, -0.01974381912146777, 0.11955157422791582, 0.4552833558018982, 0.6334026106298256, 0.9445802861066888, -0.28330275919384085, 1.179022567066906, 0.6374144085697968, -1.0683480439030069, 0.4116617413138744, -0.40194117719523115, -0.2568386374526194, -0.4272989518914054, 0.26689621483506176, -0.19819557075932573, 0.020414907616942084, -0.012578279082827265, 0.3849770260404086, -0.028657839320870182, 0.37984994577606757, -0.5411921153331869, 0.18786130455833952, 0.24103871937130686, -0.008666660036875098, -0.006052384032045744, 0.09236363468991272, 0.42619167083361853, 0.4212122018676385, -1.202158035774881, -0.034178812991405856, -0.3694604998694988, 0.13907986419991625, 0.03189015957725994, -0.14615897918896922, -0.6978295155902031, -0.3162165450604474, -0.6864968800430955, 0.3840938798722747, -0.8047269417166973, 0.08250420327201136, -0.29448526760337185, 0.12711466330494883, 0.3787555029291578, -0.9281486742490702, -0.240814364276371, 0.1315095219231265, 0.989717204038639, -0.8443002761137506, -0.124328916222441, -0.8060072486283185, 0.771326191183523, 0.41206867108486384, 0.1774622242778662, -0.6135382032942721, 0.3896094718733546, 0.10007044076522108, -0.2752807904003735, -0.35826511546832884, 0.5915691909603918, 0.7548400573039973, 0.23510219030150334, -0.13864508867765432, 0.025319863718936117, 0.6081652442679698, 0.21959349162510386, -0.2766656645850985, 0.17284117903995305, 0.32463532289763253, 1.0997744732680679, 0.5316128646388573, -0.8374303400770478, 0.5184936952706705, -0.2330893242563706, 0.15702251538465017, 0.33738154205566057, -0.9120891811097332, 0.07776104437044662, -0.4893310884394146, -0.11100233357196218, 0.5502433421051993, 0.5165216245327794, -0.8022514050439782, 0.47607270816440406, -0.08353200673471148, -0.09416973576890934, 0.0962970875984605, 0.16561968208225247, 0.06842834054114821, 0.9353168758568497, -0.17414187271377263, 0.3711414942385254, -0.7811771649821241, -0.1382570275179626, -0.7903337958453529, -1.0384810783272858, -0.3650278119605493, -0.4398662588795939, -0.9276772682259639, -0.1625005599013246, 0.34030476371701956, -0.36331575201547345, 0.2644733801531388, -0.04357720675346489, 0.5401728383818439, -0.8107260393940127, -0.39236480673935614, -0.4191943241820671, 0.5985933027217248, 0.35734879310876216, -0.7709955452699029, -0.4648230703651417, 0.39998786425484617, -0.4487775020070542, 0.18925235352102623, 0.5643777992341261, -1.2123428414868533, 0.32088446004225185, 0.28245326062035797, -0.14270247146929796, -0.12295983576881649, 0.13362040186373347, 0.03217603364614903, 0.12053410666463521, 0.0007430511592832425, -0.3807484210413206, -0.290969240725006, 0.05621644762960485, 1.1400199050357465, 0.267085508941616, -0.048088366800318263, -0.4227641256568906, 0.42757137928977496, 0.1208352862021301, -0.49500962793712644, -0.521607272273399, -0.08047237575425484, 0.03033562774930506, 0.23923654047698967, -0.22524922869213618, 0.8598947912620731, 0.3550664754593609, -0.2760033371297402, -1.1882934175365316, 0.21296448295976672, 0.8719226232277992, -0.5289035189669261, 0.4980977023622145, 0.6062866072751283, 0.2719328335660436, -0.1631173304900758, 0.16889538087032963, -0.49595848979685614, 0.29094247562898107, -0.46086002176954144, -0.6127590701866343, -0.3415431765096146, 0.34966078542140133, -0.8845722832987981, 0.17629688010621797, 0.4533428201955019, 0.020415973055672696, -0.16387163784290482, 0.5871159685911086, 0.23995431187531427, 0.07620462475416183, 0.6765217897139986, -0.16470338417602862, -0.6836253742389878, -0.30990947170724525, 0.9474256064224571, 0.6457256071653955, 0.3455617785463682, -0.8420242399048193, 0.056725407943097536, 0.17529957554038594, 0.535673609450308, 0.01861721010113132, 0.9278271050282927, -0.24339863673549467, -0.08838144891595726, 0.1648330340923178, 0.042134198528900206, -0.17254627659503396, 0.15382809655429083, -0.012856856087655608, 0.9102006574785264, 0.39867187318026953, -1.341117890654572, -0.04996057850774823, -0.0977469957619704, -0.7034372284848163, 0.2296838942132971, -0.5788602323283585, -0.14123968895925518, 0.8608993993182735, 0.48296084918439974, 0.39643093191134826, -0.5257743024706298, 0.06323834381348493, -0.39871812112706373, -0.2930574947476603, -0.8168652625262637, 0.22342126349311964, -0.9342699443962855, 0.526332318586089, -0.2884093221417552, 1.3167861484701833, 0.041341455980458644, 0.3460951465489461, 0.4327724442801674, 0.11361884907190256, -0.36516670123780276, 0.5127774818286349, -0.6542077510687968, 0.4364388781759468, -0.8236281881451882, 0.033448428143285455, 0.2900507688848053, -0.3681325817931976, -0.13053628030000808, -0.601099726548288, 0.29776286721517636, -0.4671711087124952, 0.7641147116360189, -0.8242186189228088, -0.6617930166033413, -0.4402223303571537, -0.17744178416033077, 0.20153773413954923, -0.08445864027377886, -0.3643174751908402, -0.07252211820544277, 0.6633928939370344, 0.6558603005578384, -0.7389016555188028, 0.5483405576859888, 0.2722385359325015, -1.1571101189830302, 0.47576003648120174, -0.08441389695136874, -0.679659389109299, 0.42811342344988024, 1.066193560452364, 0.5784173480007426, -0.24299246066574012, -0.9846482897417518, 1.0403793345202068, 0.17417970538591995, -0.20937973538368795, 0.1117978231046751, -0.5627872717613973, 0.5529174657051137, 0.6013198759375177, -0.45873658602234063, -0.20605168497268994, -0.14097188257777782, -0.02078006890392401, -0.547359541080258, 0.2393836931672511, 0.14881252407704498, 0.617343529257786, 0.21639996530470273, -0.41064063813140106, -0.026189349827613572, 0.5818633355730763, 0.47225105187820215, 0.29860843384775604, 0.37985855118027523, -0.7997527424433699, -0.23242414279901802, 0.29093744000298394, 0.2937764273662468, -1.55671265273086, -0.11544614750301858, 0.40566302545285604, -0.8048826559494061, -0.3309878073985297, -0.2692498543161093, 0.11535915792192956, 0.40520248670285786, 0.6231441263848808, -0.15054463770512969, 0.466760595658909, 1.023547494960276, -0.5703255601944527, -0.3210129833084884, -0.11500248030765572, 0.4993903474783471, -0.05428748257194998, -0.547607640232219, 0.33270085268405214, 0.2774844382638496, -0.18315268379551933, -0.8619582254418418, -0.024018029576596902, -0.8425727444924178, 0.1262790521720674, 0.06177074313676937, 0.13948457518892227, 0.2703177731050465, 0.4258553999682868, -0.28948606874880284, -0.8199318824279591, 0.5141385389749432, 0.02565525439449569, 0.4853141457986016, -0.6256826835954339, 0.5347913999404114, 0.15592157661269604, -0.3804581650113294, -0.316624324346287, -0.04713692687921638, 0.1191794360296847, -0.04447982081245747, 0.23424505689594236, -1.1985186847955156, -0.38577826456804015, 0.35026542148180323, -0.2936200551163998, -0.42994728556466877, 0.35314439639423506, -0.5592173337548987, -0.482250227802777, -0.06319977694522784, 0.4726094771929007, 0.6504988758048853, 0.027654427839811386, 0.680888548604284, 0.04175290637364053, 0.9384268605153043, 0.10588720470518065, 0.29148927666082186, -0.4576937155787592, 0.05543398464899362, 0.07490332558683621, -0.2749725411606284, 0.14863293497793137, -0.5402277217241224, 0.8465350725049389, 0.17269736378248235, -0.18253973445632274, -0.8872854743761734, 0.4592238060856823, 0.9638245780773604, -0.34254881473513316, 0.13872702021550454, -0.4776973947533799, 0.42479063857682015, -0.07428510096168112, -0.6485876884169072, -0.5574368675952083, 0.29709398085682864, -0.7194319047736538, -0.29744814574166595, -0.14257910693641151, 0.4354236180883474, 0.4052090953995012, -0.25445572214218876, -0.7733628616450866, 0.7373253877185867, 0.18844535442076216, -0.08195895519781808, 0.6164376566270866, 0.5594131184864379, 1.4886097136248744, -0.42101057846333806, -0.4857724457905914, 0.14612404494919162, 0.18548638529588476, -0.7516691598442572, -0.028625475670843344, -0.5657309878836629, 0.24419428246984384, -0.49563741717171794, -0.24773127767408518, -0.35769166071799674, 0.8116547176751928, -0.3215991438604865, -0.33319339577940227, -0.2999198544123826, 0.03173108998199339, 0.42293832299186973, -0.011391484654562047, -0.2382479893646336, -0.07786578251591988, -0.6131093834851643, 0.4055931167712517, -0.6183248854220684, 0.6699001065170938, 0.41167608050635446, 0.4918185840052175, -0.07408350092875962, -0.08201981886632216, -0.754839518374086, 0.09340314542810119, 0.6495778777221336, 0.8742811681154051, 0.0255237055680778, -0.4025595747101934, -0.6649320637958911, -0.524991444175444, 0.034329811261993824, -0.30933149189000164, -0.6989805362582209, -0.6752029196986443, 0.2309829077618158, 0.3981812976616082, -0.16540384597226274, 0.1278994128201703, 0.4068834587376819, -0.3484357738272085, 0.39551714906395075, 0.06312271221402636, 0.3772140435314938, 0.34606788031765173, 0.23497072965654733, -0.31261948903968356, -0.5892714561846334, -0.6603619226007778, -0.16112474100718271, -0.6598398714877377, 0.3076251439376536, -0.5711870253206148, -0.042970809879497265, 0.15401127604925505, 0.29811854180094816, -0.31672865034276926, 0.33951439456968235, 0.13761638722337835, -0.15359164957902213, 0.2986899563580196}, {-0.5408746900549061, 1.3797074231586546, 0.19710041496714448, 0.32354921141680754, -0.2386226500122668, -0.08228907626834218, -0.47030859411539344, 0.30540946309015116, -0.05846135489206097, -0.5784908340391938, 0.2531212787177357, 0.028159715393549396, -0.04630798178512511, 0.011103486630485538, 0.4718994508323132, -0.42501841596464435, 0.421927229483428, 0.7746699731395938, 0.8541759451426523, 0.31184140348868133, 0.08101501729775472, -0.01106202111580607, -1.508327352760784, -0.7827381053891909, -0.8296981554775719, -0.5072106261114526, -0.6408321291946708, 0.8032262944120147, 0.13975098972000466, -0.6551584349258877, 0.21435570244534274, -1.3124903167623623, 0.24335242020295958, -0.2360268458596919, 1.02409435643687, 0.34251955516111415, -0.10296028262404004, -0.0370297136118495, -0.5149343999592384, -0.28950909433376454, 0.45784526761707767, 0.7751302566632994, -0.21692653608981774, -0.10729250223300667, 0.2971342922162696, 0.10410256663925616, 0.7136635151906028, -1.058421679534843, 0.050405739644111235, -0.46481367812974994, 0.3949165974310077, 1.2441934732462743, 0.19588394166215597, 0.1541612428858371, 0.0815983675893585, 1.320559578894073, 1.2455693765997404, 0.18474673920583776, -0.13220200144336794, 0.49223057490841904, -0.557254901687694, -0.31573464378711347, -0.5049056030612681, -1.240669912361502, 0.5399726471913407, 1.1817035126755848, 0.4644851518263617, 2.045082113299897, 0.310871985897162, 0.7644877709147478, 0.39753957325474687, 0.019482410220580174, -0.959110504014544, 0.1769200736756649, 0.973158951378814, 1.3242114784518502, -0.018963469870581236, -0.9075176576471922, -1.0299865036046398, 0.3753404601065274, 1.1278954936004966, -0.7704973414721806, -0.8172008867468314, -0.8499138501837293, -0.2772521708261211, 0.12561638834326058, 0.7292523072581995, -0.09422978207296817, -0.2818383607308645, 0.15605937284139934, 0.55135299584649, 0.39220548169109615, -1.2893513808990475, 0.07027284084501494, -0.8104982418207825, -0.2703617534168971, 0.8278541322225605, 0.10968665569508075, -0.9029270554240723, 0.19135335246821011, 0.9779994152557934, 0.12200292273578317, 0.20336996939565322, 1.684956916497168, 0.15101458775800033, 0.695122515604854, -1.0519608650313634, 0.8787092679181535, -1.0855345310474727, -0.2657169584217663, -0.22737030849605827, -2.1854047638770946, 0.08909730333582778, 0.7071358187726613, -1.1356837387879402, 0.11774240226653176, -0.45995866689822085, 0.12367521558186165, 0.17051879955637733, 0.8844015787969943, 0.9141006587840281, 0.06491190883418574, 0.5010312105876611, -1.0261301211911062, -0.9258085259223648, -0.8966043467591058, -0.08815822403137956, 0.33896965435052095, -1.3980415555822798, 0.06308346501072468, 0.4444649455942686, -0.01807485030767445, 0.33970491192613755, 0.293724481059574, -0.11142096523044573, 0.15324067917405004, 0.7697238135642851, 0.16811811927217005, -0.2921574583598603, -0.8860573169699462, -1.5230696565027224, 1.0811042559203785, -0.6915067845717618, -0.33796433493083416, 0.6270025819443019, -1.1550566404774743, -0.7445114068315473, 0.917808596320074, 1.2665893343303576, 0.5834405386051458, -0.32306347727465506, 0.3181197072579499, 0.499914160604667, -0.5788969641595292, -1.9071927053521651, 0.15103158255377103, 0.25944576042738393, -1.4948605351972861, -0.786905560102462, 1.5825749048667144, -0.4789184462762609, 0.6817066356180418, -0.8796081773544222, -1.2285496520512384, 0.16036815017367773, 0.9694264836833975, 0.6917705463263089, -1.2187891972501494, 0.11676418756263716, 0.799363519462717, -0.19411619096226082, -0.4919628951026871, 0.8471704457126764, 0.5098906581982755, 1.087775334803326, -1.6855582037495207, 1.083532861032874, -0.8527325992347699, 0.8065201368567277, -0.053166662323301195, -1.4177436943288049, -0.3195967178516737, -0.48036455937194555, 0.19149356077716795, -0.5705565778019464, 0.536294174159139, 1.7524292767057548, 1.1196775247657487, 0.17796312375268297, 0.4991414809779506, 0.5952645796856829, -0.3833383062857755, -0.07880705509985127, 0.4716170899514135, -1.049163711735197, 1.4823690575210962, 0.7039771339601535, 0.2509756018468758, 0.07079373296164111, 0.9230883429593505, -1.4261790737511406, 0.19039307182650417, -0.3656282235936156, 0.7601638090120383, -0.1801473926804367, 3.4186510006769955, 1.0633986418946915, 0.3886754571105054, 0.04935174589899617, -0.5935191696486827, 0.47082210292201054, 0.6109291082141655, 0.035660179535596526, 0.384596821535664, 0.47873664377344877, 0.5700922674896033, 0.2783557240782273, -0.05618535841592178, -0.41223211617225836, -0.17551475232631442, 0.32507577484584754, 0.8318732320548539, 0.7988371948937489, 0.7900961005292958, -0.5093356547496004, -0.39392918083901857, 0.3718382606667323, 0.9504519296072254, -0.6429288836843522, -0.2933235983231252, -0.04283391104606857, 0.8222294393692736, -1.4014806353204856, 0.23694053893637165, -0.07551805560531814, -0.9403497834663604, 0.5943642264728035, -0.2076286153174536, 0.5945399629907248, 1.2186094717822082, -0.752382267355032, -0.06992629786008624, -0.8192199731055564, -0.8251841017870823, -0.566587486798563, 1.3380571272896775, -1.0128007257432183, -0.19268074366943144, -0.10597548667796491, -0.8918650268222735, 0.19314370161702776, -0.5748789383987479, 1.3520704893704318, 0.05358876427392175, -0.5825809368130863, -1.6776260638987697, -0.20868101310082884, 0.6535154481811062, -0.47805704788799164, -1.0619369624298933, -0.3335717667300044, -0.020534943144036442, -0.6602512158379112, 0.0010110335127226037, 0.22723518135396994, 0.32804791615505896, -0.07027600304492577, 0.34341018543263035, 0.22254402803502732, 0.5871674793791637, -0.16695829912351, -0.4527291712856465, -0.7499785663648408, 1.0186168771965391, -1.8568381616747924, 0.26498127891312445, -0.010585484465544765, 0.7881372028307252, -0.8400456040448137, -0.7977697268254607, 0.20048613279545002, -1.0367472586760984, 0.5525783651495361, 0.11134200046495768, 0.02078571737399979, 1.0042835626955808, -0.7289347372872101, -0.44715456063791537, 0.5959738506658355, 0.038862396897053224, -0.3964583225955503, 0.037450639594795304, 0.8443475880406086, -1.216459215914937, -0.38029268619929946, 0.6634312853540048, 1.927872462029782, -1.7658514009011876, 1.293155786520436, 0.5642499249531927, -0.019851531860516594, 0.1934784110115548, -0.16904928863872773, 0.04561226670354965, -2.4729720833019937, 0.8317311832870257, -0.36224629942554315, 0.9883110646853491, -0.34368526793256077, 0.1440363063893634, -0.6643409174541274, -0.6417042025670978, -0.6282870981379732, -0.5139395568866542, -1.007850208737283, -0.8166955248638456, -0.38483189586739813, -0.9489477079703992, 0.5472286618922932, -0.351405109520771, -0.8176211304217671, -0.8440749318651504, 0.40132442624675346, -0.7962201124075837, 0.0991597333173754, -0.3803991995469698, 0.21727364231219248, 0.6358114521857493, 0.9341845659113468, 0.9119871960375628, -0.38636840262078814, 0.009494773934508238, 0.8229444748552481, 0.8447748823936057, -0.5288075206573487, -0.6350457312745525, -0.3459013911217832, -0.917757046393485, -0.49322055914806384, -0.6669723002809171, -1.0777613796248962, -0.92886290000709, 0.6547491025204869, 1.3001402389648231, -0.9405352950065439, 1.0559273522137371, 0.8351901701540876, -0.5287493536670186, 0.6399383361324031, 0.33481217655031736, -1.0298659773214036, 0.5323795275227091, 0.1543766019006154, 0.1713114580883628, 0.7907523596280673, 0.7829163152063602, -0.6682091892950021, 0.9060014403735708, 0.1364543494724146, -1.3592953306475317, -0.01921568479131234, 0.5628046736068157, 0.12109261017323877, -0.5735079125696393, 0.7668182796166348, 0.8920292548428144, -0.05560560474702309, 0.7889599489622374, -0.5410591333408276, -0.04626951570271296, 0.3042570791432717, 0.30153415438380143, 0.30875166524404984, 0.22801787291766962, -0.002126217619272083, 0.1367083819945853, -0.5060630547670809, 0.34176787921876256, 0.05578220378145038, 0.3943405364145821, -0.471876381095786, 0.7687207852381953, -0.7033402999890691, -0.6432219622678969, -0.6297971438513298, 0.9039791685095097, 1.3012223112134556, 1.0954894224145177, -0.3315377589114905, -0.6627575752168413, 0.8098848320835618, 0.10025871365949175, -0.5510548757280774, 0.40154275518363713, -0.47430195531153985, -0.015102967285362465, -0.019061208784454935, -1.7009567603900353, -0.07172069317516114, -0.09386357016037572, -1.0694494717789347, -0.7371994444563262, -0.6454683314670618, -0.8159245246797805, -1.8844435599108613, -1.70568558176468, 0.5700423596038245, 0.550814921078896, 0.61628151823502, -1.1425621725631603, 0.8734263262731388, -0.8373643001241158, 1.7797434694766565, 0.05419907944925163, -1.069769982650514, -0.491112259455505, -1.0135390328172735, -1.5035464036119541, 0.5048460469566884, 0.03323445838371905, 0.2027292556792872, -0.26104786937409474, 1.0245865772512028, 0.9864416514357964, -0.2686474587101041, -0.09880407342867996, 1.1117813888174406, -0.6239329623469283, -1.3715893599901967, 1.1001977879793523, 0.31546159431633125, 0.6052935148108594, -0.8082509883578737, 0.020178940207124837, -1.0278919137339628, 0.9240161769942217, -0.09324995150852164, 1.6331895861693542, -0.7568780841033913, -0.19528449792491895, -0.03741068406043011, 0.8493970150935336, 0.4194745313366163, 0.2679364276814255, -0.8754136046833845, 0.33588102697525285, 0.7067127828936542, 1.1805124472139712, 0.7452200190258236, 0.6069068254012829, -0.10954134995863586, -0.25623212587192595, 0.5433862566491782, 0.4016652759926158, 0.3715703982786333, 0.26423436341594975, 0.116873613423561, -0.9703286680635724, 0.8676272921003849, 0.15770738687610084, 0.6794718761580814, -0.16533793790516318, -1.1339703388256501, 0.7543102028875747, -0.017255662295640586, 0.07453785244079779, 0.000509970079503182, -0.24662876643131884, 0.686426950839441, 1.0924802047656863, -0.20692221940691652, 0.7108584337261348, 0.36610981072451, -0.603027924805094, 0.09672905656865055, -0.5864239626674745, -0.26714236723484597, 0.3032794077804735, 0.17011662330866856, -0.5275478284760474, -0.00010518927047322693, 1.1408666531250804, -0.2501994817421252, -0.8675884080169979, 0.2326607382054219, -1.2444890747527007, -0.11297704534225882, 0.5060365609452573, -0.2819331783922663, -0.5083620190394146, 0.6371963676749685, 0.09928245629923708, 1.795912487124223, -0.5054298609525603, 1.5182095557636355, -1.8745105345857085, 0.355891199740602, -1.0047411450099046, -0.1236222184742728, -1.2287114849439633, -0.6281610759467646, -0.12320981388558158, -0.02534385652423554, 0.9792432141418081, -0.7616230767827813, 0.7034754535936951, -0.09009499702470498, -0.7897403632022243, 0.41348680283160205, 0.27572039640468093, -0.2612103649617131, -0.6203959637273331, -2.0315992543314394, 0.7726128271135577, -0.10100174554053466, -1.1688516166909402, -0.18004158622456815, -0.02190598788364982, 0.19701302116614094, 1.6148545049377498, -0.44320634774335027, -0.8565418066635814, -1.315592439116313, -1.411046782750301, 2.009151345414617, 0.9231524891519991, -0.25837498333031816, -1.051878453826386, 1.5085244703665524, -0.3514868636838832, 0.0454352296403139, 0.3431923941800112, 0.7536249240856238, 0.9327553819589144, 1.7253503357571984, -0.6885706380765565, -0.4844040445945973, -0.43686339895346216, 1.1094659808075824, -1.1639896504217697, -0.5319976661465202, -0.4228481077501539, 1.471647898736079, -0.5525066902358235, 0.38764650175180637, 0.1743800451164934, -1.8775151598825603, 0.11099286669242919, -0.6245970008213356, 0.06604977264120104, -0.2884561430617885, -1.007233056595855, 0.9547414645864998, 0.5759965540327279, 0.008546183866106595, -0.2609061745136511, 0.391138685552087, 0.18659992603360187, 0.3394744992004133, 0.2868183869061746, -0.8049964454947031, 1.2357832379995917, 1.2820850185758281, -0.21356763253526537, -0.4619593321013193, 0.5230756568060243, 1.026924854607586, -0.5196830224576734, -0.6749163466338819, -0.5160510502768854, -0.3998181163427311, 0.03776039805540275, 0.05839044894455348, 1.6497491867263647, 0.8288996777953419, -1.6339902158642374, 0.4627894817610963, 0.5677875236920491, -0.7485463016517488, -0.175359320082407, -0.6067368570988022, 0.34484192281886533, 1.4311320970171466, -0.5232549771797973, -0.9951550470132918, -0.1664118039050562, -0.05542720745020673, 0.9626274837122186, -1.7356518198580546, -1.1294723773097133, -0.6117334514842, -0.7263609919868866, 0.9018510246500756, -0.925894787419548, 1.4650021495446026, -0.9856315325163796, 0.25845172303953345, -1.06732009275315, -0.008180927466695253, -0.26930232255811565, -0.45751903589228554, 1.4808576102858328, -0.5174317919663145, 0.2914892055600919, 0.14347454588505457, 0.37233730729074627, 0.2687079664568613, 0.09506546086426224, 0.5208501378926254, 1.2502062198144768, -0.2683164726017988, 0.27085427904471054, -0.09372350969686673, 0.492051550607202, 1.0344143811773108, 0.5941191977594816, 0.03229200110972617, -0.5760982511554811, 1.0046758414788906, 0.23038562184368877, -0.48191458296328293, -0.1401564926666375, 0.08270125893935291, 1.0271696119630407, -1.1723998137565796, 0.048503000231879756, -0.03678649338841045, 0.20787626187421668, -0.5954638881691243, -0.3872420766391408, 0.5672649286809551, -0.34313112716742794, 0.8814534858262826, -0.33030574891116343, -0.6223703067727248, 0.6454585782687754, 0.1793327752220955, -0.2729941264647416, 0.8205202904747619, 0.9216824788420919, -0.43260154619466795, -0.5047073199567498, 1.3043374146882505, 0.07618286588852427, 0.10560777731388746, 1.1972938443773424, 0.24834692690114601, 0.12557172076281461, 0.28164376567120725, -0.13568820776788507, -0.12394201284324924, -0.6187746690480551, 1.7891835885838336, -0.05750033087011784, -0.8171288799670632, -0.8015828487194769, 1.2284605080903968, 0.40190819707302117, 0.2980347545553329, 0.4486779125678984, 0.10216833495814391, -1.5572442652035, -0.1080896134776398, 0.42936226555747214, -0.09691776243746635, -0.33908766633736054, -1.0784795351986725, 0.26062674896151033, -0.83462052253667, 1.5046953676958663, 0.8944889380283149, 0.178812239993448, -0.15468232697216014, -0.2168056109322392, 0.13050405955130912, -0.8043397875453361, -0.9267188503380033, -0.22012805211604508, 1.0818980208388747, 0.3571471408850164, 0.0048719738975132, 0.0561306984053661, -0.16422030985059105, 0.8589684047913131, -0.30430094969433685, 0.6200390023593724, 0.0008512903027803724, -0.17530907302981147, -0.8452366695290835, -0.5971182337576298, -0.97491212759552, -0.6393572456275162, -0.05043029104644927, -0.2856107218311589, -0.7350112875711942, 0.2632718872815866, -0.25958138174196005, -0.7105572933197477, 0.004298243695050586, 0.9240840963008619, 0.0812031859575522, -1.7153047478293373, -0.6935803639002587, -0.23953900886166524, 0.6096578045850679, -1.1327255540429517, 0.17899862063172872, -0.582482802438156, -0.8269421246258376, -0.6326171562351083, -1.3016802289159255, 0.33414423842085383, 0.40452142725328527, 0.517295841499437, 1.2901155829740483, 1.5015821597256478, -0.29427035136289026, 0.5034824480200047, -1.217086397821968, 1.8850444609595565, 0.7290405464322579, -0.9975607113987189, 1.0420583279075981, 1.061820924749558, -0.36230723816682603, -0.7087866249816355, -2.775270437595534, -0.8849466868891505, -2.0485686723757257, 0.45098479367072486, 1.3031130650610327, -0.015235426461365473, -0.8371422825741952, -1.526481661910451, -0.17657657524001877, -0.5253503304533719, 0.9087824070767458, -0.16284867751169396, -0.16569347010907381, 1.4459175077122586, 1.242095043414192, -0.5933016379170748, 0.24614153347387505, -0.7961801866781217, -0.8350390141743081, 0.16819730715261705, 0.0365007773847683, 1.4022873411010421, -1.4339328188429077, -0.28550049478912626, -0.18617385096756237, 0.7282293953628156, -0.14439799184959728, -0.8655041449375972, -0.06432695651209627, 1.6746498936057055, 0.16939185306841356, 0.3918778737320411, 0.13516902497148509, 0.9769939053052361, -0.05332792875428127, -1.2430293577966989, -0.20658566797883363, -0.08571638286359869, -0.6887161041228892, -0.6168535592403336, -0.07021219380515767, 0.10825304158213699}};
    std::vector<double> b = {-0.21640026470745044, 0.27800571442424127, -0.06160544971649457};

    int W_len = W.size(); 

    std::vector<Plaintext> W_pt(W_len); 
    for(int i = 0 ; i < W_len; ++i){
        W_pt[i] = this->m_cc->MakeCKKSPackedPlaintext(W[i]);
    }
    auto b_pt = this->m_cc->MakeCKKSPackedPlaintext(b);

   
    std::vector<Ciphertext<DCRTPoly>> res(W_len);
    #pragma omp parallel for
    for (int i = 0; i < W_len; ++i) {
        res[i] = m_cc->EvalInnerProduct(m_InputC, W_pt[i], 768);
    }

    auto slot_count = this->m_cc->GetRingDimension()/2;
    std::vector<double> mask = std::vector<double>(slot_count, 0.0);
    mask[0] = 1.0;
    auto mask_pt = this->m_cc->MakeCKKSPackedPlaintext(mask);    

    for(int i = 0; i < W_len; ++i){
        res[i] = this->m_cc->EvalMult(res[i], mask_pt); 
    }; 

    auto rot1 = this->m_cc->EvalRotate(res[1], -1);
    auto rot2 = this->m_cc->EvalRotate(res[2], -2);

    auto ctxts = {
        res[0], rot1, rot2
    }; 
    this->m_OutputC = this->m_cc->EvalAdd(this->m_cc->EvalAddMany(ctxts), b_pt);



}



void CKKSTaskSolver::serializeOutput()
{
    if (!Serial::SerializeToFile(m_OutputLocation, m_OutputC, SerType::BINARY))
    {
        std::cerr << " Error writing ciphertext 1" << std::endl;
    }
}


